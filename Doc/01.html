<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603279 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2166"/>

<div>
<span><div>    本章前言：<span style="font-size: unset; color: unset; font-family: unset;">本章讲如何利用VS和QT来创建一个</span><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">基本的QOpenGLWidget窗口和有关联的三个核心函数</span><span style="font-size: unset; color: unset; font-family: unset;">，因为版本更新可能会有大同小异，但基本的不会有变换，有了QT的帮助，我们不需要下载opengL、glsl、cmake只需要下载一个qt和使之跟vs链接的小插件即可，注意在下载qt的时候，记得按照opengl模块（虽然这个模块免费了，但是qt官网并没有默认放入核心三模块中）。</span></div><div><br/></div><div>     作者：本教程是我基于github上著名的learnopengl教学<a href="https://learnopengl-cn.github.io/">https://learnopengl-cn.github.io/</a>和opengl官网<a href="https://www.khronos.org/opengl">https://www.khronos.org/opengl</a>制作的个人opengl教学笔记。之所以选择Qt作为辅助，是因为qt中集成了opengl开发，让我们省去了很多原版opengl不必要的兼容操作和处理，可以把精力更好的放到图形开发上，个人能力有限，如有不足，请多指教。</div><div>    开发环境：opengl+qt+vs2017+win10</div><div>    (所有源代码全部开源公开，并且可以在我的个人公众号：<span style="font-weight: bold;">zobol的魔法藏书室</span>和博客<a href="https://github.com/zobolBlog/LearnOpenGLWithQT">https://github.com/zobolBlog/LearnOpenGLWithQT</a>下载)</div><div><br/></div><div>    个人制作视频教程：<a href="https://www.bilibili.com/video/BV1X5411w7QV/">https://www.bilibili.com/video/BV1X5411w7QV/</a></div><div>    个人技术博客：<a href="https://zobolblog.github.io/LearnOpenGLWithQT/Doc/01.html">https://zobolblog.github.io/LearnOpenGLWithQT/Doc/01.html</a></div><div><br/></div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image.png" type="image/png" data-filename="Image.png" width="453"/></div><div><br/></div><div>1.新建项目，选择GUI Application (新版的名字略有修改，但是只要选择带GUI的就可以了) </div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [1].png" type="image/png" data-filename="Image.png" width="588"/></div><div><br/></div><div>2.添加对应模块opengl、opengl extension（新版把debug和release分开了，无妨）</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [2].png" type="image/png" data-filename="Image.png" width="579"/></div><div><br/></div><div>3.选择QWidget作为继承基类，这是qt官方推荐的QOpenGLWidget就是使用QWidget作为父类的。</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [3].png" type="image/png" data-filename="Image.png" width="502"/></div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [4].png" type="image/png" data-filename="Image.png" width="527"/></div><div>其余保持不变即可</div><div><br/></div><div>4.创建QWidget项目完成，看一下项目栏，有没有疏漏。</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [5].png" type="image/png" data-filename="Image.png" width="550"/></div><div>编译之后，正常显示窗口，就是正常。</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [6].png" type="image/png" data-filename="Image.png" width="543"/></div><div><br/></div><div>5.替换父类，将QWidget替换成QOpenGLWidget，一共两处</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [7].png" type="image/png" data-filename="Image.png" width="507"/></div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [8].png" type="image/png" data-filename="Image.png" width="509"/></div><div><br/></div><div>6.添加对应头文件,两个。其中关于opengl版本的文件，至少要填到3.3之后（这之后opengl的版本更新都变化不大）。</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [9].png" type="image/png" data-filename="Image.png" width="548"/></div><div><span>    </span>类QOpenGLFunctions_x_x_Core是对OpenGL某个版本的包装器,这样就可以使用原版函数，如果不写，我们就只能用qt封装的另外一套函数，也可以用但是跟learnopengl教程不一样。</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [10].png" type="image/png" data-filename="Image.png" width="527"/></div><div>因为都是向下兼容型，选择3.3版本之后，你的计算机能带动的就行。</div><div><br/></div><div>7.三个关键函数，<span style="text-indent: 0px;">QOpenGLWidget都制作成保护函数，都需要我们去继承，重新实现。</span></div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [11].png" type="image/png" data-filename="Image.png" width="405"/></div><div><br/></div><div>8.在源代码中继承，并实现。</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [12].png" type="image/png" data-filename="Image.png" width="611"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>       virtual void initializeGL();//负责初始化,就是缓冲对象vao、vbo、ebo、着色器、纹理、摄像机。</div><div>       virtual void resizeGL(int w, int h);//视图、窗口大小改变，自动调用</div><div>       virtual void paintGL();//画，渲染一次。循环要添加update()函数</div></div><div><br/></div><div>9.initializeGL()函数，负责初始化,就是缓冲对象vao、vbo、ebo、着色器、纹理、摄像机。</div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px;"><span>    </span>This virtual function is called once before the first call to</span> <span style="text-indent: 0px; color: #007330;">paintGL</span><span style="text-indent: 0px;">() or</span> <span style="text-indent: 0px; color: #007330;">resizeGL</span><span style="text-indent: 0px;">(). Reimplement it in a subclass.</span><span style="color: unset; font-family: unset; font-size: unset;">This function should set up any required OpenGL resources and state.</span></div><div style="margin: 0px; text-indent: 0px;"><span style="color: unset; font-family: unset; font-size: unset;"><span>    </span>There is no need to call</span> <span style="font-family: unset; font-size: unset; color: rgb(0, 115, 48);">makeCurrent</span><span style="color: unset; font-family: unset; font-size: unset;">() because this has already been done when this function is called. Note however that the framebuffer is not yet available at this stage, so avoid issuing draw calls from here. Defer such calls to</span> <span style="font-family: unset; font-size: unset; color: rgb(0, 115, 48);">paintGL</span><span style="color: unset; font-family: unset; font-size: unset;">() instead.</span></div><div><br/></div><div>10.resizeGL(int w, int h)函数，/视图、窗口大小改变，自动调用</div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px;"><span>    </span>This virtual function is called whenever the widget needs to be painted. Reimplement it in a subclass.</span><span style="color: unset; font-family: unset; font-size: unset;">There is no need to call</span> <span style="font-family: unset; font-size: unset; color: rgb(0, 115, 48);">makeCurrent</span><span style="color: unset; font-family: unset; font-size: unset;">() because this has already been done when this function is called.</span></div><div style="margin: 0px; text-indent: 0px;"><span style="color: unset; font-family: unset; font-size: unset;"><span>    </span>Before invoking this function, the context and the framebuffer are bound, and the viewport is set up by a call to glViewport(). No other state is set and no clearing or drawing is performed by the framework.</span></div><div style="margin: 0px; text-indent: 0px;"><span style="color: unset; font-family: unset; font-size: unset;"><br/></span></div><div style="margin: 0px; text-indent: 0px;"><span style="color: unset; font-family: unset; font-size: unset;">11.p</span>aintGL()函数画，渲染一次。循环要添加update()函数</div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px;"><span>    </span>Sets the requested surface</span> <span style="text-indent: 0px; font-style: italic;">format</span><span style="text-indent: 0px;">.</span><span style="color: unset; font-family: unset; font-size: unset;">When the format is not explicitly set via this function, the format returned by</span> <span style="font-family: unset; font-size: unset; color: rgb(0, 115, 48);">QSurfaceFormat::defaultFormat</span><span style="color: unset; font-family: unset; font-size: unset;">() will be used. This means that when having multiple OpenGL widgets, individual calls to this function can be replaced by one single call to</span> <span style="font-family: unset; font-size: unset; color: rgb(0, 115, 48);">QSurfaceFormat::setDefaultFormat</span><span style="color: unset; font-family: unset; font-size: unset;">() before creating the first widget.</span></div><div style="margin: 0px; text-indent: 0px;"><span style="color: unset; font-family: unset; font-size: unset;"><br/></span></div><div>12. 在cpp文件中修改一下，paintGL函数的内容。</div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [13].png" type="image/png" data-filename="Image.png" width="598"/></div><div><br/></div><div>13.结果，看见一个黑色框框就是正确的<span style="text-indent: 0px;">QOpenGLWidget窗口。</span></div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [14].png" type="image/png" data-filename="Image.png" width="566"/></div><div><br/></div><div><br/></div><div><b>源代码：</b></div><div><img src="(1)《QT+OpenGL学习之我见》初始化窗口及三个重要函数 vs+Qt_files/Image [15].png" type="image/png" data-filename="Image.png" width="243"/></div><div><font style="font-size: 10pt; font-family: &quot;Cambria Math&quot;;">HelloOpenGL.h：</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &lt;QtWidgets/QWidget&gt;</div><div>#include &quot;ui_HelloOpenGL.h&quot;</div><div>#include &lt;QOpenGLWidget&gt;</div><div>#include &lt;QOpenGLFunctions_3_3_Core&gt;</div><div>class HelloOpenGL : public QOpenGLWidget</div><div>{</div><div>       Q_OBJECT</div><div>public:</div><div>       HelloOpenGL(QWidget *parent = Q_NULLPTR);</div><div>protected:</div><div>       virtual void initializeGL();//负责初始化,就是缓冲对象vao、vbo、ebo、着色器、纹理、摄像机。</div><div>       virtual void resizeGL(int w, int h);//视图、窗口大小改变，自动调用</div><div>       virtual void paintGL();//画，渲染一次。循环要添加update()函数</div><div>private:</div><div>       Ui::HelloOpenGLClass ui;</div><div>};</div></div><div><span style="font-family: NSimSun;"><font style="font-size: 10pt;">HelloOpenGL.cpp：</font></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &quot;HelloOpenGL.h&quot;</div><div>HelloOpenGL::HelloOpenGL(QWidget *parent)</div><div>       : QOpenGLWidget(parent)</div><div>{</div><div>}</div><div>void HelloOpenGL::initializeGL()</div><div>{</div><div>}</div><div>void HelloOpenGL::resizeGL(int w, int h)</div><div>{</div><div>}</div><div>void HelloOpenGL::paintGL()</div><div>{</div><div>       update();</div><div>}</div></div><div>main.cpp:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &quot;HelloOpenGL.h&quot;</div><div>#include &lt;QtWidgets/QApplication&gt;</div><div>int main(int argc, char *argv[])</div><div>{</div><div>       QApplication a(argc, argv);</div><div>       HelloOpenGL w;</div><div>       w.show();</div><div>       return a.exec();</div><div>}</div></div><div><br/></div></span>
</div></body></html> 